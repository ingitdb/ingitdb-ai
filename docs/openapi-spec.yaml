openapi: 3.0.3
info:
  title: inGitDB Server API
  description: |
    inGitDB is a versioned database for collaboration that stores data in text files (JSON, YAML, columnar storage).
    
    This API provides RESTful access to database operations with full Git-based version control.
    
    ## Key Concepts
    - **Database**: A named collection of tables (stored as a Git repository or subdirectory)
    - **Table**: A collection of records with a defined schema (stored as JSON/YAML files)
    - **Record**: Individual data entries validated against table schema
    - **Branch**: Git branch for versioning data changes
    - **Commit**: Git commit representing a snapshot of database state
    
    ## Features
    - Full CRUD operations on databases, tables, and records
    - Git-based version control with branches and commits
    - Schema validation for data integrity
    - Query and filter capabilities
    - Conflict-free merging with automatic conflict detection
    
  version: 1.0.0
  contact:
    name: inGitDB Team
    url: https://github.com/ingitdb
  license:
    name: MIT
    url: https://github.com/ingitdb/ingitdb-server/blob/main/LICENSE

servers:
  - url: http://localhost:3000/api/v1
    description: Local development server
  - url: https://api.ingitdb.io/v1
    description: Production server

tags:
  - name: databases
    description: Database management operations
  - name: tables
    description: Table schema and structure operations
  - name: records
    description: Record CRUD operations
  - name: version-control
    description: Git version control operations (branches, commits, merge)
  - name: query
    description: Query and search operations
  - name: health
    description: Health and status endpoints

paths:
  /health:
    get:
      summary: Health check
      description: Check if the API server is running and healthy
      operationId: getHealth
      tags:
        - health
      responses:
        '200':
          description: Server is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthStatus'

  /databases:
    get:
      summary: List all databases
      description: Retrieve a list of all databases
      operationId: listDatabases
      tags:
        - databases
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
      responses:
        '200':
          description: List of databases
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DatabaseList'
        '401':
          $ref: '#/components/responses/UnauthorizedError'

    post:
      summary: Create a new database
      description: Create a new database with optional initial configuration
      operationId: createDatabase
      tags:
        - databases
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateDatabaseRequest'
      responses:
        '201':
          description: Database created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Database'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '409':
          $ref: '#/components/responses/ConflictError'

  /databases/{dbName}:
    parameters:
      - $ref: '#/components/parameters/DatabaseNameParam'
      
    get:
      summary: Get database details
      description: Retrieve detailed information about a specific database
      operationId: getDatabase
      tags:
        - databases
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Database details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Database'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

    delete:
      summary: Delete a database
      description: Permanently delete a database and all its data
      operationId: deleteDatabase
      tags:
        - databases
      security:
        - bearerAuth: []
      responses:
        '204':
          description: Database deleted successfully
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

  /databases/{dbName}/tables:
    parameters:
      - $ref: '#/components/parameters/DatabaseNameParam'
      
    get:
      summary: List tables in a database
      description: Retrieve all tables in the specified database
      operationId: listTables
      tags:
        - tables
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
      responses:
        '200':
          description: List of tables
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TableList'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

    post:
      summary: Create a new table
      description: Create a new table with a defined schema
      operationId: createTable
      tags:
        - tables
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTableRequest'
      responses:
        '201':
          description: Table created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Table'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '409':
          $ref: '#/components/responses/ConflictError'

  /databases/{dbName}/tables/{tableName}:
    parameters:
      - $ref: '#/components/parameters/DatabaseNameParam'
      - $ref: '#/components/parameters/TableNameParam'
      
    get:
      summary: Get table schema
      description: Retrieve the schema and metadata for a specific table
      operationId: getTable
      tags:
        - tables
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Table details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Table'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

    put:
      summary: Update table schema
      description: Update the schema of an existing table
      operationId: updateTable
      tags:
        - tables
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateTableRequest'
      responses:
        '200':
          description: Table updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Table'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

    delete:
      summary: Delete a table
      description: Permanently delete a table and all its records
      operationId: deleteTable
      tags:
        - tables
      security:
        - bearerAuth: []
      responses:
        '204':
          description: Table deleted successfully
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

  /databases/{dbName}/tables/{tableName}/records:
    parameters:
      - $ref: '#/components/parameters/DatabaseNameParam'
      - $ref: '#/components/parameters/TableNameParam'
      
    get:
      summary: Query records
      description: Retrieve records from a table with optional filtering, sorting, and pagination
      operationId: queryRecords
      tags:
        - records
        - query
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
        - name: filter
          in: query
          description: JSON filter object for querying records
          required: false
          schema:
            type: string
            example: '{"status": "active", "age": {"$gt": 18}}'
        - name: sort
          in: query
          description: Sort field and direction (e.g., "name:asc" or "created_at:desc")
          required: false
          schema:
            type: string
            example: 'name:asc'
        - name: fields
          in: query
          description: Comma-separated list of fields to return
          required: false
          schema:
            type: string
            example: 'id,name,email'
      responses:
        '200':
          description: List of records matching the query
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RecordList'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

    post:
      summary: Insert records
      description: Insert one or more records into a table
      operationId: insertRecords
      tags:
        - records
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InsertRecordsRequest'
      responses:
        '201':
          description: Records inserted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InsertRecordsResponse'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

  /databases/{dbName}/tables/{tableName}/records/{recordId}:
    parameters:
      - $ref: '#/components/parameters/DatabaseNameParam'
      - $ref: '#/components/parameters/TableNameParam'
      - $ref: '#/components/parameters/RecordIdParam'
      
    get:
      summary: Get a specific record
      description: Retrieve a single record by its ID
      operationId: getRecord
      tags:
        - records
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Record details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Record'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

    put:
      summary: Update a record
      description: Update an existing record (full replacement)
      operationId: updateRecord
      tags:
        - records
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateRecordRequest'
      responses:
        '200':
          description: Record updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Record'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

    patch:
      summary: Partially update a record
      description: Update specific fields of a record
      operationId: patchRecord
      tags:
        - records
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchRecordRequest'
      responses:
        '200':
          description: Record patched successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Record'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

    delete:
      summary: Delete a record
      description: Permanently delete a record
      operationId: deleteRecord
      tags:
        - records
      security:
        - bearerAuth: []
      responses:
        '204':
          description: Record deleted successfully
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

  /databases/{dbName}/branches:
    parameters:
      - $ref: '#/components/parameters/DatabaseNameParam'
      
    get:
      summary: List branches
      description: Retrieve all branches in the database repository
      operationId: listBranches
      tags:
        - version-control
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of branches
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BranchList'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

    post:
      summary: Create a new branch
      description: Create a new branch from a specified commit or current HEAD
      operationId: createBranch
      tags:
        - version-control
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateBranchRequest'
      responses:
        '201':
          description: Branch created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Branch'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '409':
          $ref: '#/components/responses/ConflictError'

  /databases/{dbName}/branches/{branchName}:
    parameters:
      - $ref: '#/components/parameters/DatabaseNameParam'
      - $ref: '#/components/parameters/BranchNameParam'
      
    get:
      summary: Get branch details
      description: Retrieve information about a specific branch
      operationId: getBranch
      tags:
        - version-control
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Branch details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Branch'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

    delete:
      summary: Delete a branch
      description: Delete a branch (cannot delete current branch or main branch)
      operationId: deleteBranch
      tags:
        - version-control
      security:
        - bearerAuth: []
      responses:
        '204':
          description: Branch deleted successfully
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

  /databases/{dbName}/commits:
    parameters:
      - $ref: '#/components/parameters/DatabaseNameParam'
      
    get:
      summary: List commits
      description: Retrieve commit history for the database
      operationId: listCommits
      tags:
        - version-control
      security:
        - bearerAuth: []
      parameters:
        - name: branch
          in: query
          description: Branch name to list commits from
          required: false
          schema:
            type: string
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/LimitParam'
      responses:
        '200':
          description: List of commits
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommitList'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

  /databases/{dbName}/commits/{sha}:
    parameters:
      - $ref: '#/components/parameters/DatabaseNameParam'
      - $ref: '#/components/parameters/CommitShaParam'
      
    get:
      summary: Get commit details
      description: Retrieve detailed information about a specific commit
      operationId: getCommit
      tags:
        - version-control
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Commit details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Commit'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

  /databases/{dbName}/merge:
    parameters:
      - $ref: '#/components/parameters/DatabaseNameParam'
      
    post:
      summary: Merge branches
      description: Merge one branch into another with automatic conflict detection
      operationId: mergeBranches
      tags:
        - version-control
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MergeRequest'
      responses:
        '200':
          description: Merge completed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MergeResult'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '409':
          description: Merge conflict detected
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MergeConflict'

  /databases/{dbName}/checkout:
    parameters:
      - $ref: '#/components/parameters/DatabaseNameParam'
      
    post:
      summary: Switch branch
      description: Switch to a different branch
      operationId: checkoutBranch
      tags:
        - version-control
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CheckoutRequest'
      responses:
        '200':
          description: Branch switched successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CheckoutResult'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authentication

  parameters:
    DatabaseNameParam:
      name: dbName
      in: path
      description: Database name
      required: true
      schema:
        type: string
        pattern: '^[a-zA-Z0-9_-]+$'
        
    TableNameParam:
      name: tableName
      in: path
      description: Table name
      required: true
      schema:
        type: string
        pattern: '^[a-zA-Z0-9_-]+$'
        
    RecordIdParam:
      name: recordId
      in: path
      description: Record ID
      required: true
      schema:
        type: string
        
    BranchNameParam:
      name: branchName
      in: path
      description: Branch name
      required: true
      schema:
        type: string
        
    CommitShaParam:
      name: sha
      in: path
      description: Commit SHA
      required: true
      schema:
        type: string
        pattern: '^[a-f0-9]{40}$'
        
    PageParam:
      name: page
      in: query
      description: Page number (1-based)
      required: false
      schema:
        type: integer
        minimum: 1
        default: 1
        
    LimitParam:
      name: limit
      in: query
      description: Number of items per page
      required: false
      schema:
        type: integer
        minimum: 1
        maximum: 100
        default: 20

  responses:
    BadRequestError:
      description: Bad request - Invalid input
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
            
    UnauthorizedError:
      description: Unauthorized - Authentication required
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
            
    NotFoundError:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
            
    ConflictError:
      description: Conflict - Resource already exists or cannot be modified
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

  schemas:
    HealthStatus:
      type: object
      properties:
        status:
          type: string
          enum: [healthy, degraded, unhealthy]
        version:
          type: string
          example: '1.0.0'
        uptime:
          type: integer
          description: Server uptime in seconds
        timestamp:
          type: string
          format: date-time
      required:
        - status
        - version
        - timestamp

    Error:
      type: object
      properties:
        error:
          type: object
          properties:
            code:
              type: string
              example: 'INVALID_INPUT'
            message:
              type: string
              example: 'Database name must contain only alphanumeric characters, hyphens, and underscores'
            details:
              type: object
              additionalProperties: true
          required:
            - code
            - message
      required:
        - error

    Database:
      type: object
      properties:
        name:
          type: string
          example: 'my-database'
        description:
          type: string
          example: 'User and product data'
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        current_branch:
          type: string
          example: 'main'
        table_count:
          type: integer
          example: 5
        storage_format:
          type: string
          enum: [json, yaml, columnar]
          default: json
        metadata:
          type: object
          additionalProperties: true
      required:
        - name
        - created_at
        - updated_at
        - current_branch
        - storage_format

    DatabaseList:
      type: object
      properties:
        databases:
          type: array
          items:
            $ref: '#/components/schemas/Database'
        pagination:
          $ref: '#/components/schemas/Pagination'
      required:
        - databases
        - pagination

    CreateDatabaseRequest:
      type: object
      properties:
        name:
          type: string
          pattern: '^[a-zA-Z0-9_-]+$'
          example: 'my-database'
        description:
          type: string
          example: 'User and product data'
        storage_format:
          type: string
          enum: [json, yaml, columnar]
          default: json
        initial_branch:
          type: string
          default: 'main'
        metadata:
          type: object
          additionalProperties: true
      required:
        - name

    Table:
      type: object
      properties:
        name:
          type: string
          example: 'users'
        description:
          type: string
          example: 'User account information'
        schema:
          type: object
          description: JSON Schema for record validation
          example:
            type: object
            properties:
              id:
                type: string
              name:
                type: string
              email:
                type: string
                format: email
            required: [id, name]
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        record_count:
          type: integer
          example: 1234
        indexes:
          type: array
          items:
            type: string
          example: ['id', 'email']
      required:
        - name
        - schema
        - created_at
        - updated_at

    TableList:
      type: object
      properties:
        tables:
          type: array
          items:
            $ref: '#/components/schemas/Table'
        pagination:
          $ref: '#/components/schemas/Pagination'
      required:
        - tables
        - pagination

    CreateTableRequest:
      type: object
      properties:
        name:
          type: string
          pattern: '^[a-zA-Z0-9_-]+$'
          example: 'users'
        description:
          type: string
          example: 'User account information'
        schema:
          type: object
          description: JSON Schema for record validation
        indexes:
          type: array
          items:
            type: string
          example: ['id', 'email']
      required:
        - name
        - schema

    UpdateTableRequest:
      type: object
      properties:
        description:
          type: string
        schema:
          type: object
          description: Updated JSON Schema for record validation
        indexes:
          type: array
          items:
            type: string

    Record:
      type: object
      properties:
        _id:
          type: string
          description: Auto-generated record ID
          example: 'rec_1234567890'
        _created_at:
          type: string
          format: date-time
        _updated_at:
          type: string
          format: date-time
        _version:
          type: integer
          description: Record version number
        data:
          type: object
          additionalProperties: true
          description: Actual record data conforming to table schema
      required:
        - _id
        - _created_at
        - _updated_at
        - _version
        - data

    RecordList:
      type: object
      properties:
        records:
          type: array
          items:
            $ref: '#/components/schemas/Record'
        pagination:
          $ref: '#/components/schemas/Pagination'
      required:
        - records
        - pagination

    InsertRecordsRequest:
      type: object
      properties:
        records:
          type: array
          items:
            type: object
            additionalProperties: true
          example:
            - id: '1'
              name: 'John Doe'
              email: 'john@example.com'
            - id: '2'
              name: 'Jane Smith'
              email: 'jane@example.com'
        commit_message:
          type: string
          example: 'Added new users'
      required:
        - records

    InsertRecordsResponse:
      type: object
      properties:
        inserted:
          type: array
          items:
            $ref: '#/components/schemas/Record'
        commit:
          type: object
          properties:
            sha:
              type: string
            message:
              type: string
      required:
        - inserted
        - commit

    UpdateRecordRequest:
      type: object
      properties:
        data:
          type: object
          additionalProperties: true
        commit_message:
          type: string
          example: 'Updated user email'
      required:
        - data

    PatchRecordRequest:
      type: object
      properties:
        data:
          type: object
          additionalProperties: true
          example:
            email: 'newemail@example.com'
        commit_message:
          type: string
          example: 'Updated email address'
      required:
        - data

    Branch:
      type: object
      properties:
        name:
          type: string
          example: 'feature-branch'
        commit:
          type: object
          properties:
            sha:
              type: string
            message:
              type: string
            author:
              type: string
            timestamp:
              type: string
              format: date-time
        is_current:
          type: boolean
        created_at:
          type: string
          format: date-time
      required:
        - name
        - commit
        - is_current

    BranchList:
      type: object
      properties:
        branches:
          type: array
          items:
            $ref: '#/components/schemas/Branch'
        current_branch:
          type: string
      required:
        - branches
        - current_branch

    CreateBranchRequest:
      type: object
      properties:
        name:
          type: string
          pattern: '^[a-zA-Z0-9_/-]+$'
          example: 'feature-branch'
        from_commit:
          type: string
          description: Commit SHA to branch from (defaults to current HEAD)
        checkout:
          type: boolean
          default: false
          description: Whether to switch to the new branch immediately
      required:
        - name

    Commit:
      type: object
      properties:
        sha:
          type: string
          example: 'a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0'
        message:
          type: string
          example: 'Added new user records'
        author:
          type: object
          properties:
            name:
              type: string
            email:
              type: string
              format: email
        timestamp:
          type: string
          format: date-time
        parent_commits:
          type: array
          items:
            type: string
        changes:
          type: object
          properties:
            files_changed:
              type: integer
            insertions:
              type: integer
            deletions:
              type: integer
      required:
        - sha
        - message
        - author
        - timestamp

    CommitList:
      type: object
      properties:
        commits:
          type: array
          items:
            $ref: '#/components/schemas/Commit'
        pagination:
          $ref: '#/components/schemas/Pagination'
      required:
        - commits
        - pagination

    MergeRequest:
      type: object
      properties:
        source_branch:
          type: string
          example: 'feature-branch'
        target_branch:
          type: string
          example: 'main'
        commit_message:
          type: string
          example: 'Merge feature-branch into main'
        strategy:
          type: string
          enum: [merge, squash, rebase]
          default: merge
      required:
        - source_branch
        - target_branch

    MergeResult:
      type: object
      properties:
        status:
          type: string
          enum: [success, conflict]
        commit:
          type: object
          properties:
            sha:
              type: string
            message:
              type: string
        files_changed:
          type: integer
        conflicts:
          type: array
          items:
            type: string
          description: List of files with conflicts (empty if no conflicts)
      required:
        - status

    MergeConflict:
      type: object
      properties:
        error:
          type: object
          properties:
            code:
              type: string
              enum: [MERGE_CONFLICT]
            message:
              type: string
            conflicts:
              type: array
              items:
                type: object
                properties:
                  file:
                    type: string
                  table:
                    type: string
                  records:
                    type: array
                    items:
                      type: string
                      description: Record IDs in conflict
      required:
        - error

    CheckoutRequest:
      type: object
      properties:
        branch:
          type: string
          example: 'feature-branch'
      required:
        - branch

    CheckoutResult:
      type: object
      properties:
        previous_branch:
          type: string
        current_branch:
          type: string
        files_changed:
          type: integer
      required:
        - previous_branch
        - current_branch

    Pagination:
      type: object
      properties:
        page:
          type: integer
          minimum: 1
        limit:
          type: integer
          minimum: 1
        total:
          type: integer
          minimum: 0
        total_pages:
          type: integer
          minimum: 0
      required:
        - page
        - limit
        - total
        - total_pages
